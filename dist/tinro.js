var P=Object.create,x=Object.defineProperty,U=Object.getPrototypeOf,Z=Object.prototype.hasOwnProperty,B=Object.getOwnPropertyNames,G=Object.getOwnPropertyDescriptor;var H=t=>x(t,"__esModule",{value:!0});var J=(t,r)=>{H(t);for(var n in r)x(t,n,{get:r[n],enumerable:!0})},Q=(t,r,n)=>{if(H(t),r&&typeof r=="object"||typeof r=="function")for(let a of B(r))!Z.call(t,a)&&a!=="default"&&x(t,a,{get:()=>r[a],enumerable:!(n=G(r,a))||n.enumerable});return t},k=t=>t&&t.__esModule?t:Q(x(t!=null?P(U(t)):{},"default",{value:t,enumerable:!0}),t);J(exports,{Route:()=>D,active:()=>L,meta:()=>O,router:()=>b});var l=k(require("svelte/internal"));var C=k(require("svelte")),E=k(require("svelte/store")),d=k(require("svelte")),W=k(require("svelte/store"));function S(t,r=!1){return t=t.slice(t.startsWith("/#")?2:0,t.endsWith("/*")?-2:void 0),t.startsWith("/")||(t="/"+t),t==="/"&&(t=""),r&&!t.endsWith("/")&&(t+="/"),t}function A(t,r){t=S(t,!0),r=S(r,!0);let n=[],a={},e=!0,o=t.split("/").map(c=>c.startsWith(":")?(n.push(c.slice(1)),"([^\\/]+)"):c).join("\\/"),i=r.match(new RegExp(`^${o}$`));return i||(e=!1,i=r.match(new RegExp(`^${o}`))),i?(n.forEach((c,g)=>a[c]=i[g+1]),{exact:e,params:a,part:i[0].slice(0,-1)}):null}function M(t,r,n){if(n==="")return t;if(n[0]==="/")return n;let a=i=>i.split("/").filter(c=>c!==""),e=a(t),o=r?a(r):[];return"/"+o.map((i,c)=>e[c]).join("/")+"/"+n}function _(t,r,n,a){let e=[r,"data-"+r].reduce((o,i)=>{let c=t.getAttribute(i);return n&&t.removeAttribute(i),c===null?o:c},!1);return!a&&e===""?!0:e||a||!1}function V(t){let r=t.split("&").map(n=>n.split("=")).reduce((n,a)=>{let e=a[0];if(!e)return n;let o=a.length>1?a[a.length-1]:!0;return typeof o=="string"&&o.includes(",")&&(o=o.split(",")),n[e]===void 0?n[e]=[o]:n[e].push(o),n},{});return Object.entries(r).reduce((n,a)=>(n[a[0]]=a[1].length>1?a[1]:a[1][0],n),{})}function X(t){throw new Error("[Tinro] "+t)}var y=1,q=2,z=3,$=4;function ee(t,r,n,a){return t===y?r&&r():t===q?n&&n():a&&a()}function te(){return!window||window.location.pathname==="srcdoc"?z:y}var h={HISTORY:y,HASH:q,MEMORY:z,OFF:$,run:ee,getDeafault:te},F,v,p=re();function re(){let t=h.getDeafault(),r,n=o=>window.onhashchange=window.onpopstate=v=null,a=o=>r&&r(T(t));function e(o){o&&(t=o),n(),t!==h.OFF&&h.run(t,i=>window.onpopstate=a,i=>window.onhashchange=a)&&a()}return{mode:o=>e(o),get:o=>T(t),go(o){console.log("go(href)"),ne(t,o),a()},replace(o){console.log("going to replace 3"),ae(t,o),a()},start(o){r=o,e()},stop(){r=null,e(h.OFF)}}}function ae(t,r){console.log("Replacing location",r),h.run(t,n=>history.replaceState({},"",r),n=>window.location.hash=r,n=>v=r)}function ne(t,r){console.log("SET LOCATION (new)"),h.run(t,n=>history.pushState({},"",r),n=>window.location.hash=r,n=>v=r)}function T(t){let r=F,n=F=h.run(t,e=>window.location.pathname+window.location.search,e=>String(window.location.hash.slice(1)||"/"),e=>v||"/"),a=n.match(/^([^?#]+)(?:\?([^#]+))?(?:\#(.+))?$/);return{url:n,from:r,path:a[1]||"",query:V(a[2]||""),hash:a[3]||""}}function j(t){let r=d.getContext("tinro");r&&(r.exact||r.fallback)&&X(`${t.fallback?"<Route fallback>":`<Route path="${t.path}">`}  can't be inside ${r.fallback?"<Route fallback>":`<Route path="${r.path||"/"}"> with exact path`}`);let n=t.fallback?"fallbacks":"childs",a=W.writable({}),e={router:{},exact:!1,pattern:null,meta:{},parent:r,fallback:t.fallback,redirect:!1,replace:!1,firstmatch:!1,breadcrumb:null,matched:!1,childs:new Set,activeChilds:new Set,fallbacks:new Set,update(o){e.exact=!o.path.endsWith("/*"),e.pattern=S(`${e.parent&&e.parent.pattern||""}${o.path}`),e.redirect=o.redirect,e.replace=o.replace,e.firstmatch=o.firstmatch,e.breadcrumb=o.breadcrumb,e.match()},register:()=>{if(e.parent)return e.parent[n].add(e),()=>{e.parent[n].delete(e),e.router.un&&e.router.un()}},show:()=>{t.onShow(),!e.fallback&&e.parent&&e.parent.activeChilds.add(e)},hide:()=>{t.onHide(),!e.fallback&&e.parent&&e.parent.activeChilds.delete(e)},match:async()=>{e.matched=!1;let{path:o,url:i,from:c,query:g}=e.router,f=A(e.pattern,o);if(console.log("route",e),!e.fallback&&f&&e.redirect&&(!e.exact||e.exact&&f.exact)){await d.tick();let u=M(o,e.parent&&e.parent.pattern,e.redirect);return console.log("next url 1:",u),e.replace?(console.log("in here redirect 1"),b.replaceWith(u)):(console.log("going going gone"),b.goto(u))}if(e.meta=f&&{from:c,url:i,query:g,match:f.part,pattern:e.pattern,breadcrumbs:e.parent&&e.parent.meta&&e.parent.meta.breadcrumbs.slice()||[],params:f.params,subscribe:a.subscribe},e.breadcrumb&&e.meta&&e.meta.breadcrumbs.push({name:e.breadcrumb,path:f.part}),a.set(e.meta),f&&!e.fallback&&(!e.exact||e.exact&&f.exact)&&(!e.parent||!e.parent.firstmatch||!e.parent.matched)?(t.onMeta(e.meta),e.parent&&(e.parent.matched=!0),e.show()):e.hide(),await d.tick(),f&&!e.fallback&&(e.childs.size>0&&e.activeChilds.size==0||e.childs.size==0&&e.fallbacks.size>0)){let u=e;for(;u.fallbacks.size==0;)if(u=u.parent,!u)return;u&&u.fallbacks.forEach(m=>{if(m.redirect){let w=M("/",m.parent&&m.parent.pattern,m.redirect);console.log("next url 2:",w),m.replace?(console.log("in here replace 2"),b.replaceWith(w)):(console.log("in here redirect 2"),console.log("going going gone"),b.goto(w))}else m.show()})}}};return d.setContext("tinro",e),d.onMount(()=>e.register()),e.router.un=b.subscribe(o=>{e.router.path=o.path,e.router.url=o.url,e.router.query=o.query,e.router.from=o.from,e.pattern!==null&&e.match()}),e}function O(){return d.getContext("tinro").meta}var b=oe();function oe(){let{subscribe:t}=E.writable(p.get(),r=>{p.start(r),console.log("setting up some listener");let n=le(p.go);return()=>{p.stop(),n()}});return{subscribe:t,goto:r=>p.go(r),replaceWith:r=>p.replace(r),params:ce,meta:O,useHashNavigation:r=>p.mode(r?h.HASH:h.HISTORY),mode:{hash:()=>p.mode(h.HASH),history:()=>p.mode(h.HISTORY),memory:()=>p.mode(h.MEMORY)}}}function L(t){let r=_(t,"href"),n=_(t,"exact",!0),a=_(t,"active-class",!0,"active");return{destroy:b.subscribe(e=>{let o=A(r,e.path);o&&(o.exact&&n||!n)?t.classList.add(a):t.classList.remove(a)})}}function le(t){let r=n=>{let a=n.target.closest("a[href]"),e=a&&_(a,"target",!1,"_self"),o=a&&_(a,"tinro-ignore"),i=n.ctrlKey||n.metaKey||n.altKey||n.shiftKey;if(e=="_self"&&!o&&!i&&a){let c=a.getAttribute("href").replace(/^\/#/,"");/^\/\/|^[a-zA-Z]+:/.test(c)||(n.preventDefault(),t(c.startsWith("/")?c:a.href.replace(window.location.origin,"")))}};return addEventListener("click",r),()=>removeEventListener("click",r)}function ce(){return C.getContext("tinro").meta.params}var ie=t=>({params:t&2,meta:t&4}),Y=t=>({params:t[1],meta:t[2]});function I(t){let r,n=t[10].default,a=l.create_slot(n,t,t[9],Y);return{c(){a&&a.c()},m(e,o){a&&a.m(e,o),r=!0},p(e,o){a&&a.p&&o&518&&l.update_slot(a,n,e,e[9],o,ie,Y)},i(e){r||(l.transition_in(a,e),r=!0)},o(e){l.transition_out(a,e),r=!1},d(e){a&&a.d(e)}}}function se(t){let r,n,a=t[0]&&I(t);return{c(){a&&a.c(),r=l.empty()},m(e,o){a&&a.m(e,o),l.insert(e,r,o),n=!0},p(e,[o]){e[0]?a?(a.p(e,o),o&1&&l.transition_in(a,1)):(a=I(e),a.c(),l.transition_in(a,1),a.m(r.parentNode,r)):a&&(l.group_outros(),l.transition_out(a,1,1,()=>{a=null}),l.check_outros())},i(e){n||(l.transition_in(a),n=!0)},o(e){l.transition_out(a),n=!1},d(e){a&&a.d(e),e&&l.detach(r)}}}function ue(t,r,n){let{$$slots:a={},$$scope:e}=r,{path:o="/*"}=r,{fallback:i=!1}=r,{redirect:c=!1}=r,{replace:g=!1}=r,{firstmatch:f=!1}=r,{breadcrumb:u=null}=r,m=!1,w={},R={},N=j({fallback:i,onShow(){n(0,m=!0)},onHide(){n(0,m=!1)},onMeta(s){n(2,R=s),n(1,w=R.params)}});return t.$$set=s=>{"path"in s&&n(3,o=s.path),"fallback"in s&&n(4,i=s.fallback),"redirect"in s&&n(5,c=s.redirect),"replace"in s&&n(6,g=s.replace),"firstmatch"in s&&n(7,f=s.firstmatch),"breadcrumb"in s&&n(8,u=s.breadcrumb),"$$scope"in s&&n(9,e=s.$$scope)},t.$$.update=()=>{if(t.$$.dirty&488){e:N.update({path:o,redirect:c,replace:g,firstmatch:f,breadcrumb:u})}},[m,w,R,o,i,c,g,f,u,e,a]}var K=class extends l.SvelteComponent{constructor(r){super();l.init(this,r,ue,se,l.safe_not_equal,{path:3,fallback:4,redirect:5,replace:6,firstmatch:7,breadcrumb:8})}},D=K;
